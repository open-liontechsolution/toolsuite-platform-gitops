# Local QA Environment Configuration
# Namespace: security-qa
# Deployment: local k3s cluster with Longhorn storage

keycloak:
  fullnameOverride: keycloak-qa

  replicaCount: 2

  auth:
    adminUser: admin
    existingSecret: "keycloak-admin-credentials"
    passwordSecretKey: "admin-password"

  production: true

  postgresql:
    enabled: false

  externalDatabase:
    host: "platform-postgres-qa-rw.data-qa.svc.cluster.local"
    port: 5432
    database: "keycloak_qa"
    existingSecret: "keycloak-db-credentials"
    existingSecretUserKey: "db-user"
    existingSecretPasswordKey: "db-password"
    namespace: "data-qa"

  service:
    type: ClusterIP

  ingress:
    enabled: false

  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "2"
      memory: "3Gi"

  podLabels:
    app.kubernetes.io/part-of: security-platform
    environment: qa
    deployment: local

  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/name: keycloak
            topologyKey: kubernetes.io/hostname

  persistence:
    storageClass: "longhorn"

sealedSecret:
  enabled: true
  dbCredentials:
    name: keycloak-db-credentials
    encryptedData:
      db-user: "REPLACE_WITH_ENCRYPTED_USERNAME"
      db-password: "REPLACE_WITH_ENCRYPTED_PASSWORD"
  adminCredentials:
    name: keycloak-admin-credentials
    encryptedData:
      admin-password: "REPLACE_WITH_ENCRYPTED_ADMIN_PASSWORD"

networkPolicy:
  enabled: true
